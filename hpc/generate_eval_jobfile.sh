source ./eval.jobfile.vars

if [ -z "$HPC_SETVARS_GUARD" ]
then
    source "./setvars.sh"
fi

echo "#!/bin/bash" > eval.jobfile

echo "#SBATCH --ntasks=1" >> eval.jobfile
echo "#SBATCH --cpus-per-task=1" >> eval.jobfile 
echo "#SBATCH --partition=haswell" >> eval.jobfile
echo "#SBATCH --mem-per-cpu=8192" >> eval.jobfile
echo "#SBATCH --time=04:00:00" >> eval.jobfile
echo "#SBATCH --job-name=eval_drones_veins_project" >> eval.jobfile
echo "#SBATCH --output=/home/dmmo937c/logs/eval_drones_veins_project-%j.out" >> eval.jobfile
echo "#SBATCH --error=/home/dmmo937c/logs/eval_drones_veins_project-%j.err" >> eval.jobfile
echo "#SBATCH --mail-type=all" >> eval.jobfile
echo "#SBATCH --mail-user=dmitriy.monakhov@mailbox.tu-dresden.de" >> eval.jobfile
if [ ! -z "$DEPENDENCY" ]
then
    # afterok:20
    echo "#SBATCH --dependency=afterok:$DEPENDENCY" >> eval.jobfile
fi

echo "source ~/scripts/hpc/setvars.sh" >> eval.jobfile
echo "srun singularity exec -C -H ~/:/root --bind $SCRATCH_WORKSPACE:$SINGULARITY_WORKSPACE_MNT:rw,$BEEGFS_WORKSPACE:$SINGULARITY_BEEGFS_MNT:rw ./ubuntu \"/root/scripts/hpc/singularity-executors/singularity_eval_project.sh\"" >> eval.jobfile

echo "# AUTOGENERATED FILE! DO NOT EDIT!" >> ./eval.jobfile
